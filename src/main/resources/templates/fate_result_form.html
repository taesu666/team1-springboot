<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ì‚¬ì£¼ - result</title>

<!-- Bootstrap -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<style>
:root {
	--accent: #2f6f6d; /* í‹¸ í¬ì¸íŠ¸ ì»¬ëŸ¬ */
	--accent-2: #9ccdc6; /* ë°ì€ í‹¸ */
	--ink: #1f2937; /* ë³¸ë¬¸ ê¸€ììƒ‰ */
	--muted: #6b7280;
	--line: rgba(15, 23, 42, .08);
	--radius: 16px;
}

body {
	background: #f9fafb;
}

.fate-page {
	max-width: 960px;
	margin: 30px auto;
	margin-top: 0;
	padding: 0 20px;
	justify-items: center;
	justify-content: center;
}

.title {
	font-size: 1.6rem;
	font-weight: 800;
	margin: 12px 0 22px;
	color: var(--ink);
	text-align: center;
}

/* ì¹´ë“œ */
.card {
	background: #fff;
	border: 1px solid var(--line);
	border-radius: var(--radius);
	box-shadow: 0 10px 30px rgba(15, 23, 42, .06);
	padding: 22px;
	margin-bottom: 20px;
	width: 100%;
}

/* ìš”ì•½ ì¹´ë“œ */
.summary {
	display: flex;
	justify-content: space-between;
	align-items: center;
	flex-wrap: wrap;
}

.pill {
	display: inline-flex;
	align-items: center;
	gap: 8px;
	padding: 8px 14px;
	border-radius: 999px;
	background: #f3faf8;
	border: 1px solid #daeee9;
	color: #0f3d3a;
	font-weight: 700;
}

.kv {
	color: var(--muted);
	font-size: 1.1rem;
}

.kv b {
	color: var(--ink)
}
.kvB {
	color: var(--bs-dark)
}

/* ì˜¤í–‰ ë¶„í¬ */
.bars {
	margin-top: 10px;
}

.bars .row {
	display: grid;
	grid-template-columns: 140px 1fr 64px;
	align-items: center;
	gap: 12px;
	margin: 12px 0;
}

.label {
	font-weight: 700;
	color: #374151;
}

.value {
	font-weight: 800;
	color: #111827;
	text-align: right;
}

.meter {
	position: relative;
	height: 12px;
	border-radius: 999px;
	overflow: hidden;
	background: #eef2f1;
	border: 1px solid #e5e7eb;
}

.fill {
	position: absolute;
	left: 0;
	top: 0;
	height: 100%;
	width: clamp(0%, calc(( var(--val, 0)/var(--max, 100))* 100%), 100%);
	background: linear-gradient(90deg, var(--accent), var(--accent-2));
}

/* ìš´ì„¸ ê²°ê³¼ */
.fortune {
	display: grid;
	grid-template-columns: 260px 1fr;
	gap: 18px;
}

@media ( max-width :720px) {
	.fortune {
		grid-template-columns: 1fr
	}
}

.select-box select {
	width: 100%;
	height: 44px;
	padding: 10px 12px;
	border-radius: 12px;
	border: 1px solid #d1d5db;
	background: #fff;
	outline: none;
	transition: box-shadow .15s ease, border-color .15s ease;
}

.select-box select:focus {
	border-color: #b9ded8;
	box-shadow: 0 0 0 .2rem rgba(47, 111, 109, .15)
}

.detail {
	min-height: 96px;
	border: 1px solid var(--line);
	border-radius: 12px;
	padding: 14px 16px;
	font-size: 1.05rem;
	background: #ffffff;
}

.detail .hint {
	color: var(--muted);
	margin-bottom: 6px;
	font-size: .95rem
}

.detail .text {
	white-space: pre-wrap;
	line-height: 1.6
}

/* ë²„íŠ¼ */
.actions {
	display: flex;
	justify-content: center;
	margin-top: 15px;
	gap: 15px;
}

.btn-custom {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding: 0 18px;
	border-radius: 12px;
	border: 2px solid black;
	cursor: pointer;
	font-weight: 700;
	transition: transform .06s ease, filter .1s ease, box-shadow .15s ease;
	background: var(--accent);
	color: #fff;
	box-shadow: 0 6px 16px rgba(47, 111, 109, .18);
}

.btn-custom:hover {
	filter: brightness(1.05)
}

.btn-custom:active {
	transform: translateY(1px)
}
</style>
</head>
<body>
	<!-- í—¤ë” -->
	<div th:replace="fragments/header :: headerFragment"></div>

	<div class="fate-page">
		<div class="title-box">ì‚¬ì£¼ ê²°ê³¼</div>

		<!-- ìš”ì•½ -->
		<div class="card summary">
			<div class="pill">
				ğŸ‘¤ <span th:text="${resultVO.userName}">ì´ë¦„</span>
			</div>
			<div class="kv">
				ì´í‰: <b th:text="${resultVO.total}">0</b>
			</div>
		</div>

		<div class="card bars">
			<div class="row" id="row-tree">
				<div class="label">ğŸŒ³ ëª©(æœ¨)</div>
				<div class="meter">
					<div class="fill"></div>
				</div>
				<div class="value" th:text="${resultVO.tree}">0</div>
			</div>
			<div class="row" id="row-fire">
				<div class="label">ğŸ”¥ í™”(ç«)</div>
				<div class="meter">
					<div class="fill"></div>
				</div>
				<div class="value" th:text="${resultVO.fire}">0</div>
			</div>
			<div class="row" id="row-soil">
				<div class="label">â›°ï¸ í† (åœŸ)</div>
				<div class="meter">
					<div class="fill"></div>
				</div>
				<div class="value" th:text="${resultVO.soil}">0</div>
			</div>
			<div class="row" id="row-steel">
				<div class="label">âš™ï¸ ê¸ˆ(é‡‘)</div>
				<div class="meter">
					<div class="fill"></div>
				</div>
				<div class="value" th:text="${resultVO.steel}">0</div>
			</div>
			<div class="row" id="row-water">
				<div class="label">ğŸ’§ ìˆ˜(æ°´)</div>
				<div class="meter">
					<div class="fill"></div>
				</div>
				<div class="value" th:text="${resultVO.water}">0</div>
			</div>
		</div>

		<!-- ìš´ì„¸ ìƒì„¸ -->
		<div class="card fortune">
			<div class="select-box">
				<label for="fateOption"
					style="display: block; margin-bottom: 8px; font-weight: 700; color: #374151;">ìš´ì„¸
					í•­ëª©</label> <select name="fateOption" id="fateOption"
					onchange="handleOnChange(this)">
					<option value="love">ì—°ì• ìš´</option>
					<option value="health">ê±´ê°•ìš´</option>
					<option value="money">ì¬ë¬¼ìš´</option>
					<option value="job">ì§ì—…ìš´</option>
				</select>
			</div>
			<div class="detail">
				<div class="hint">ìš´ì„¸ ê²°ê³¼</div>
				<b id="detail" class="kvB" th:text="${resultVO.love}">ë‚´ìš©</b>
			</div>
		</div>

		<!-- ë²„íŠ¼ -->
		<div class="actions">
			<button class="button" onclick="location.href='home.do'">í™ˆìœ¼ë¡œ</button>
			<button class="btn-custom" onclick="location.href='travel.do'">ì—¬í–‰ì§€
				ì¶”ì²œ</button>
		</div>
	</div>

	<script th:inline="javascript">
		function handleOnChange(e) {
			const value = e.value;
			let text = "";
			if (value === "love") {
				text = /*[[${resultVO.love}]]*/"";
			} else if (value === "health") {
				text = /*[[${resultVO.health}]]*/"";
			} else if (value === "money") {
				text = /*[[${resultVO.money}]]*/"";
			} else if (value === "job") {
				text = /*[[${resultVO.job}]]*/"";
			}
			document.getElementById('detail').innerText = text;
		}
		window.onload = function() {
			const select = document.querySelector("select[name='fateOption']");
			handleOnChange(select);
		}
	</script>
	<script th:inline="javascript">
  // íŒ: ê° ì˜¤í–‰ ê°’ì„ JSë¡œ ê°€ì ¸ì™€ ìµœëŒ€ê°’ ê¸°ì¤€ í¼ì„¼íŠ¸ ê³„ì‚° í›„ ë„ˆë¹„ ì ìš©
  window.onload = function() {
    // ì˜¤í–‰ê°’ë“¤
    const tree = /*[[${resultVO.tree}]]*/0;
    const fire = /*[[${resultVO.fire}]]*/0;
    const soil = /*[[${resultVO.soil}]]*/0;
    const steel = /*[[${resultVO.steel}]]*/0;
    const water = /*[[${resultVO.water}]]*/0;

    const max = Math.max(tree, fire, soil, steel, water, 1); // 0 ì˜ˆë°©ìš© 1 ìµœì†Œê°’

    // ê° rowë³„ .fill ìš”ì†Œ ë„ˆë¹„ ì„¤ì • (í¼ì„¼íŠ¸ë¡œ ì‚¬ìš©)
    document.querySelector("#row-tree .fill").style.width = (tree / max * 100) + "%";
    document.querySelector("#row-fire .fill").style.width = (fire / max * 100) + "%";
    document.querySelector("#row-soil .fill").style.width = (soil / max * 100) + "%";
    document.querySelector("#row-steel .fill").style.width = (steel / max * 100) + "%";
    document.querySelector("#row-water .fill").style.width = (water / max * 100) + "%";
    
    // ê¸°ì¡´ ìš´ì„¸ ìƒì„¸ í…ìŠ¤íŠ¸ ë³€ê²½ í•¨ìˆ˜ í˜¸ì¶œ (ì„ íƒ ì˜µì…˜ ì´ˆê¸°í™”)
    const select = document.querySelector("select[name='fateOption']");
    if(select) {
      handleOnChange(select);
    }
  };
</script>
	
</body>
</html>